<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiche Bilan Tennis - Stage Premium</title>
    <style>
        @media print {
            body { margin: 0; }
            .no-print { display: none; }
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 10px;
            background: white;
            color: black;
            line-height: 1.2;
            font-size: 12px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
         .title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin: 15px 0;
            letter-spacing: 2px;
        }
        
        .form-section {
            margin-bottom: 10px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 8px;
            align-items: center;
        }
        
        .form-field {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-field label {
            font-weight: bold;
            min-width: 100px;
            font-size: 11px;
        }
        
        .form-field input[type="text"], .form-field input[type="number"] {
            border: 2px solid black;
            padding: 4px;
            background: white;
            min-width: 120px;
            height: 20px;
            font-size: 11px;
        }
        
        .checkbox-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 15px;
            height: 15px;
            accent-color: black;
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        
        .stats-table th, .stats-table td {
            border: 2px solid black;
            padding: 8px;
            text-align: center;
            font-weight: bold;
            font-size: 11px;
        }
        
        .stats-table th {
            background: #f5f5f5;
        }
        
        .stats-table input {
            border: none;
            background: transparent;
            text-align: center;
            width: 60px;
            font-weight: bold;
            font-size: 11px;
        }
        
        .evaluation-section {
            margin: 10px 0;
        }
        
        .evaluation-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .evaluation-table th {
            background: black;
            color: white;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .evaluation-row {
            border: 2px solid black;
        }
        
        .evaluation-row td {
            padding: 6px;
            border-right: 2px solid black;
            font-weight: bold;
            font-size: 11px;
        }
        
        .evaluation-row td:first-child {
            background: #f9f9f9;
            min-width: 180px;
        }
        
        .color-options {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            padding: 4px;
        }
        
        .color-radio {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #333;
            cursor: pointer;
            position: relative;
            transition: transform 0.2s;
        }
        
        .color-radio:hover {
            transform: scale(1.1);
        }
        
        .color-radio input[type="radio"] {
            display: none;
        }
        
        .color-radio input[type="radio"]:checked + .color-circle::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 18px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }
        
        .color-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
        }
        
        .red { background-color: #DC143C; }
        .orange { background-color: #FF8C00; }
        .yellow { background-color: #FFD700; }
        .green { background-color: #228B22; }
        
        .comments-section {
            margin-top: 20px;
        }
        
        .comment-field {
            margin-bottom: 15px;
        }
        
        .comment-field label {
            font-weight: bold;
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .comment-field textarea {
            width: 100%;
            border: 3px solid black;
            padding: 12px;
            resize: vertical;
            font-family: Arial, sans-serif;
            font-size: 14px;
        }
        
        .comment-field.small textarea {
            height: 60px;
        }
        
        .comment-field.large textarea {
            height: 80px;
        }
        
        .footer-fields {
            display: flex;
            gap: 40px;
            margin-top: 15px;
        }
        
        .footer-field {
            flex: 1;
        }
        
        .footer-field label {
            font-weight: bold;
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .footer-field input {
            width: 100%;
            border: 3px solid black;
            padding: 12px;
            font-size: 14px;
        }
        
        .download-btn {
            background: #DC143C;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 25px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        
        .download-btn:hover {
            background: #B22222;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .section-divider {
            margin: 20px 0;
            height: 3px;
            background: #333;
        }
    </style>
</head>
<body>
    <div class="no-print">
        <button class="download-btn" onclick="generatePDF()">📄 TÉLÉCHARGER LE PDF INTERACTIF</button>
    </div>

    <div class="header">
      <img src="logo.png" alt="Logo" style="height: 80px; object-fit: contain;">
   </div>


    <h1 class="title">FICHE BILAN - STAGE PREMIUM</h1>
    
    <div class="form-section">
        <div class="form-row">
            <div class="form-field">
                <label>Prénom</label>
                <input type="text" id="prenom" name="prenom" placeholder="Saisir le prénom">
            </div>
            <div class="form-field">
                <label>Année n.o:</label>
                <input type="text" id="annee_no" name="annee_no" style="width: 100px;" placeholder="2024">
            </div>
            <div class="checkbox-group">
                <label>Masculin</label>
                <input type="checkbox" id="masculin" name="sexe" value="M">
                <label>Féminin</label>
                <input type="checkbox" id="feminin" name="sexe" value="F">
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-field">
                <label>Année de naissance</label>
                <input type="text" id="annee_naissance" name="annee_naissance" placeholder="2010">
            </div>
            <div class="form-field">
                <label>Classement</label>
                <input type="text" id="classement" name="classement" placeholder="15/5">
            </div>
        </div>
    </div>
    
    <div class="section-divider"></div>
    
    <table class="stats-table">
        <thead>
            <tr>
                <th>Matchs joués</th>
                <th>Victoires</th>
                <th>Défaites</th>
                <th>% de victoires</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="number" id="matchs_joues" name="matchs_joues" placeholder="0" min="0"></td>
                <td><input type="number" id="victoires" name="victoires" placeholder="0" min="0"></td>
                <td><input type="number" id="defaites" name="defaites" placeholder="0" min="0" readonly></td>
                <td><input type="number" id="pourcentage" name="pourcentage" placeholder="0" readonly>%</td>
            </tr>
        </tbody>
    </table>
    
    <div class="section-divider"></div>
    
    <div class="evaluation-section">
        <table class="evaluation-table">
            <thead>
                <tr>
                    <th style="width: 35%;">Bilan Tennis</th>
                    <th>Commentaire personnalisé:</th>
                </tr>
            </thead>
        </table>
        
        <table class="evaluation-table">
            <tbody>
                <tr class="evaluation-row">
                    <td>Intention de jeu</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="intention_jeu" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="intention_jeu" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="intention_jeu" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="intention_jeu" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Lecture du jeu</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="lecture_jeu" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="lecture_jeu" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="lecture_jeu" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="lecture_jeu" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Service</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="service" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="service" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="service" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="service" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Attitude entre les points</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="attitude" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="attitude" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="attitude" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="attitude" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Gestion de match</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="gestion_match" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="gestion_match" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="gestion_match" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="gestion_match" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Déplacement</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="deplacement" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="deplacement" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="deplacement" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="deplacement" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Niveau global</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="niveau_global" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="niveau_global" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="niveau_global" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="niveau_global" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <div class="section-divider"></div>
        
        <table class="evaluation-table">
            <thead>
                <tr>
                    <th style="width: 35%;">Bilan Vie en groupe</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr class="evaluation-row">
                    <td>Autonomie</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="autonomie" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="autonomie" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="autonomie" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="autonomie" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Respect du cadre</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="respect_cadre" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="respect_cadre" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="respect_cadre" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="respect_cadre" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Relations aux autres</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="relations_autres" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="relations_autres" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="relations_autres" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="relations_autres" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr class="evaluation-row">
                    <td>Esprit de groupe</td>
                    <td>
                        <div class="color-options">
                            <label class="color-radio">
                                <input type="radio" name="esprit_groupe" value="red">
                                <div class="color-circle red"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="esprit_groupe" value="orange">
                                <div class="color-circle orange"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="esprit_groupe" value="yellow">
                                <div class="color-circle yellow"></div>
                            </label>
                            <label class="color-radio">
                                <input type="radio" name="esprit_groupe" value="green">
                                <div class="color-circle green"></div>
                            </label>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <div class="section-divider"></div>
    
    <div class="comments-section">
        <div class="comment-field small">
            <label>Qualités remarquées</label>
            <textarea id="qualites" name="qualites" placeholder="Saisir les qualités remarquées du joueur..."></textarea>
        </div>
        
        <div class="comment-field small">
            <label>Points à améliorer</label>
            <textarea id="points_ameliorer" name="points_ameliorer" placeholder="Saisir les points à améliorer..."></textarea>
        </div>
        
        <div class="comment-field large">
            <label>Vision pour la suite avec ton coach</label>
            <textarea id="vision_suite" name="vision_suite" placeholder="Objectifs et recommandations pour la suite de l'apprentissage..."></textarea>
        </div>
        
        <div class="footer-fields">
            <div class="footer-field">
                <label>Coach référent</label>
                <input type="text" id="coach_referent" name="coach_referent" placeholder="Nom du coach">
            </div>
            
            <div class="footer-field">
                <label>Date</label>
                <input type="date" id="date" name="date">
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        // Auto-calculate percentage and defeats
        function calculateStats() {
            const victoires = parseInt(document.getElementById('victoires').value) || 0;
            const matchs = parseInt(document.getElementById('matchs_joues').value) || 0;
            
            if (matchs > 0) {
                const defaites = matchs - victoires;
                const percentage = Math.round((victoires / matchs) * 100);
                
                document.getElementById('defaites').value = Math.max(0, defaites);
                document.getElementById('pourcentage').value = percentage;
            } else {
                document.getElementById('defaites').value = '';
                document.getElementById('pourcentage').value = '';
            }
        }
        
        // Add event listeners for automatic calculation
        document.getElementById('victoires').addEventListener('input', calculateStats);
        document.getElementById('matchs_joues').addEventListener('input', calculateStats);
        
        // Validation to prevent victories > matches
        document.getElementById('victoires').addEventListener('input', function() {
            const victoires = parseInt(this.value) || 0;
            const matchs = parseInt(document.getElementById('matchs_joues').value) || 0;
            
            if (victoires > matchs && matchs > 0) {
                alert('Le nombre de victoires ne peut pas être supérieur au nombre de matchs joués');
                this.value = matchs;
                calculateStats();
            }
        });
        
        // Handle gender selection (exclusive checkboxes)
        document.getElementById('masculin').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('feminin').checked = false;
            }
        });
        
        document.getElementById('feminin').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('masculin').checked = false;
            }
        });
        
        // Generate PDF function - single page only
        async function generatePDF() {
            try {
                // Check if required libraries are loaded
                if (typeof window.jspdf === 'undefined' || typeof html2canvas === 'undefined') {
                    alert('Erreur: Les bibliothèques PDF ne sont pas chargées. Veuillez rafraîchir la page.');
                    return;
                }
                
                const { jsPDF } = window.jspdf;
                
                // Show loading message
                const originalText = document.querySelector('.download-btn').innerHTML;
                document.querySelector('.download-btn').innerHTML = '⏳ Génération en cours...';
                document.querySelector('.download-btn').disabled = true;
                
                // Hide the download button before capturing
                document.querySelector('.no-print').style.display = 'none';
                
                // Use html2canvas to capture the form - optimized for single page
                const canvas = await html2canvas(document.body, {
                    scale: 1.2,
                    useCORS: true,
                    backgroundColor: '#ffffff',
                    allowTaint: true,
                    scrollX: 0,
                    scrollY: 0
                });
                
                // Show the button again
                document.querySelector('.no-print').style.display = 'block';
                document.querySelector('.download-btn').innerHTML = originalText;
                document.querySelector('.download-btn').disabled = false;
                
                const imgData = canvas.toDataURL('image/png', 1.0);
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Calculate dimensions to fit on single A4 page
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 297; // A4 height in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                // If image is taller than page, scale it down to fit
                if (imgHeight > pageHeight) {
                    const scaleFactor = pageHeight / imgHeight;
                    const scaledWidth = imgWidth * scaleFactor;
                    const scaledHeight = pageHeight;
                    const xOffset = (imgWidth - scaledWidth) / 2; // Center horizontally
                    
                    pdf.addImage(imgData, 'PNG', xOffset, 0, scaledWidth, scaledHeight);
                } else {
                    // Image fits, center it vertically
                    const yOffset = (pageHeight - imgHeight) / 2;
                    pdf.addImage(imgData, 'PNG', 0, yOffset, imgWidth, imgHeight);
                }
                
                // Get the player name for filename
                const prenom = document.getElementById('prenom').value || 'Joueur';
                const date = new Date().toLocaleDateString('fr-FR').replace(/\//g, '-');
                
                pdf.save(`Fiche_Bilan_${prenom}_${date}.pdf`);
                
                // Success message
                alert('✅ PDF généré avec succès !');
                
            } catch (error) {
                console.error('Erreur lors de la génération du PDF:', error);
                alert('❌ Erreur lors de la génération du PDF. Veuillez réessayer.');
                
                // Reset button
                document.querySelector('.download-btn').innerHTML = originalText;
                document.querySelector('.download-btn').disabled = false;
                document.querySelector('.no-print').style.display = 'block';
            }
        }
        
        // Set current date by default
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
        });
        
        // Add some visual feedback for color selection
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                // Add a small animation when selected
                this.nextElementSibling.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    this.nextElementSibling.style.transform = 'scale(1)';
                }, 200);
            });
        });
    </script>
</body>
</html>